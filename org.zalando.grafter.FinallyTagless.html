<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>Finally tagless</title>
    <link href="./images/s2.ico"                                   type="image/x-icon" rel="specs2 icon"/>
    <link href="./css/opensans-fonts.css"                          type="text/css"     rel="stylesheet" />
    <link href="./css/bootstrap.min.css"                           type="text/css"     rel="stylesheet" />
    <link href="./css/font-awesome.min.css"                        type="text/css"     rel="stylesheet" />
    <link href="./css/prettify.css"                                type="text/css"     rel="stylesheet" />
    <link href="./css/tabber.css"                                  type="text/css"     rel="stylesheet" />
    <link href="./css/tipuesearch.css"                             type="text/css"     rel="stylesheet" />
    <link href="./css/specs2.css"                                  type="text/css"     rel="stylesheet" />
    <link href="./css/specs2-user.css"                             type="text/css"     rel="stylesheet" />

    <script src="./javascript/jquery.js"                           type="text/javascript"></script>
    <script src="./javascript/jquery.jstree.js"                    type="text/javascript"></script>
    <script src="./javascript/tabber.js"                           type="text/javascript"></script>
    <script src="./javascript/tabber_start.js"                     type="text/javascript"></script>
    <script src="./javascript/prettify.js"                         type="text/javascript"></script>
    <script src="./javascript/specs2.js"                           type="text/javascript"></script>
    <script src="./javascript/specs2-user.js"                      type="text/javascript"></script>
    <script src="./javascript/tipuesearch/tipuesearch_set.js"      type="text/javascript"></script>
    <script src="./javascript/tipuesearch/tipuesearch_contents.js" type="text/javascript"></script>
    <script src="./javascript/tipuesearch/tipuesearch.min.js"      type="text/javascript"></script>

</head>
<body onload="prettyPrint(); tabberAutomatic([])">

<div class="container">

<div class="col-md-1"></div>

<div class="col-md-1"></div>




<div class="col-md-10 col-sm-9 col-xs-9">
<h1>Finally tagless</h1>
<div id="tipue_search_content"></div>

<p>The <a href="http://okmij.org/ftp/tagless-final/index.html">“finally tagless”</a> style for organising software functionalities is more and more popular. Grafter supports this approach by allowing you to specify a type constructor as the type parameter of a component:</p>
<pre><code class="prettyprint">import org.zalando.grafter.macros.{defaultReader, reader}
import cats.Monad

@defaultReader[DatabaseUserOperations]
trait UserOperations[F[_]] {
  def getUser(name: String): F[User]
  def createUser(name: String): F[User]
}

@reader
case class DatabaseUserOperations[F[_]](config: DbConfig)(implicit val m: Monad[F]) extends UserOperations[F] {

  def getUser(name: String): F[User] = ???
  def createUser(name: String): F[User] = ???

}</code></pre>
<p>As you can see there is a minor drawback because you would probably like to write <code class="prettyprint">case class DatabaseUserOperations[F[_] : Monad]</code>. This is not currently possible because of <a href="https://github.com/scala/bug/issues/10589">this Scala bug</a>. Please vote for it or even better propose a PR on the Scala project!</p>
</div>

</div>

</body>
</html>